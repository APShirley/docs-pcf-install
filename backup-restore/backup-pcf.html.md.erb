---
title: Backing Up Pivotal Cloud Foundry
owner: RelEng
---

<strong><%= modified_date %></strong>

<% $this_topic = 'backup-pcf' %>

This topic describes the procedure for backing up your critical backend PCF components with BOSH Backup and Restore (BBR), a command-line tool for backing up and restoring BOSH deployments. To restore your backup, see the [Restoring Pivotal Cloud Foundry from Backup](restore-pcf.html) topic.

<p class="note"><strong>Note</strong>: To back up PCF manually, see the <a href="backup-pcf-manual.html">Backing Up Pivotal Cloud Foundry Manually</a> topic.</p>

Pivotal recommends the following:

* Back up your installation settings frequently, especially before making any changes to your PCF deployment, such as configuration of any tiles in Ops Manager.
* Make redundant copies of your backups and store them in multiple locations in order to minimize the risk of losing your backups in the event of a disaster.
* Attempt a test restore on every backup in order to validate it.

## <a id='overview'></a>Overview

BBR is a binary that runs backup scripts included with BOSH releases. BBR backs up the following PCF components:

* Elastic Runtime

Operators download the BBR binary and transfer it to a jumpbox. Then they run BBR from the jumpbox, specifying the name of the BOSH deployment to back up.

BBR examines the jobs in the BOSH deployment, and triggers the backup script for each release in the prescribed order. The backup artifacts are drained to the jumpbox, where the operator can transfer them to storage and use them to [restore](restore-pcf.html) PCF.

The following diagram shows a sample backup flow.

<%= image_tag('backup-flow.png') %>

## <a id='jumpbox'></a>Step 1: Set Up Your Jumpbox

Set up your jumpbox with the following settings:

bbr copies the backed up data from the instances to the jumpbox, so make sure you have minimal network latency between the two, to reduce transfer times.

bbr always tries to connect to the VMs on their private IP, so the jumpbox needs to be in the same network as the deployed VMs. bbr does not support SSH gateways. 

This tool should be placed on a jumpbox that is able to communicate with the network that your BOSH deployment is on and has sufficient storage to house the backups you intend to keep on it. For instance, a PCF backup will be at least 1.5GB in size.

The jumpbox must have sufficient space for the backup. A PCF backup will be at least 1.5 GB in size.

The jumpbox must also communicate with the network that contains your BOSH deployment. BBR needs access to the following:

<p>The <code>bbr</code> utility will thus require access to the following:</p>

<table>
<tr>
<th>VM</th>
<th>Default Port</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>BOSH Director</td>
<td>25555</td>
<td><code>bbr</code> interacts with the BOSH director API</td>
</tr>
<tr>
<td>Deployed Instances</td>
<td>22</td>
<td><code>bbr</code> uses SSH to orchestrate the backup on the instances</td>
</tr>
<tr>
<td>BOSH Director UAA</td>
<td>8443</td>
<td><code>bbr</code> interacts with the UAA API for authentication, if necessary</td>
</tr>
</table>



## <a id='scp'></a>Step 2: Transfer BBR to the Jumpbox

## <a id='export'></a>Export Installation Settings ##

Pivotal recommends that you back up your installation settings by exporting
frequently. This option is only available after you have deployed at least one time.
Always export an installation before following the steps in the [Import Installation Settings](./restore-pcf.html#import) section of the [Restoring Pivotal Cloud Foundry from Backup](./restore-pcf.html) topic.

<p class="note"><strong>Note</strong>: Exporting your installation only backs up your installation settings. It does not back up your virtual machines (VMs) or any external MySQL databases.</p>

From the **Installation Dashboard** in the Ops Manager interface, click your user name at the top right navigation. Select **Settings**.

**Export installation settings** exports the current PCF installation
settings and assets.
When you export an installation, the exported file contains the base VM images,
all necessary packages, and references to the installation IP addresses.
As a result, an exported installation file can exceed 5 GB in size.

<%= image_tag("settings.png") %>

<p class='note'><strong>Note</strong>: For versions of Ops Manager 1.3 or older, the process of archiving files for export may exceed the timeout limit of 600 seconds and result in a <code>500</code> error. To resolve this issue, you can manually increase the timeout value, or assign additional resources to the Ops Manager VM to improve performance. For more information, see the <a href="https://support.pivotal.io/hc/en-us/articles/206113627">Pivotal Support Knowledge Base</a>.</p>



